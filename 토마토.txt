from collections import*
N,M=map(int,input().split())
G=[[*map(int,input().split())]for _ in' '*M]
Q=deque()
C=[N*M,0]
D=[(1,0),(-1,0),(0,1),(0,-1)]
for i in range(M):
  for j in range(N):
    C[0]-=abs(G[i][j])
    if G[i][j]==1:Q.append((i, j))
while Q:
  X,Y=Q[0][0],Q.popleft()[1]
  for d in D:
    x,y=X+d[0],Y+d[1]
    if 0<=x<M and 0<=y<N and G[x][y]==0:
        C[0]-=1
        Q.append((x, y))
        G[x][y]=G[X][Y]+1
  if not Q:C[1]=G[X][Y]-1
print(C[1]if C[0]==0else-1)